<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Mikhail Play</title>

<style>
body {
  background:#222;
  color:white;
  font-family:Arial;
  text-align:center;
}

canvas {
  background:#f2d16b;
  border:2px solid white;
  display:block;
  width: 100%;
  margin:10px auto;
}

button {
  padding:12px;
  margin:5px;
  font-size:28px;
  cursor:pointer;
  width:70px;
  height:60px;
}
</style>
</head>

<body>

<h1>üèÉ Boxer Mikhail</h1>

<canvas id="game" width="600" height="200"></canvas>

<p>
  Points: <span id="score">0</span> |
  Health: <span id="lives">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</span> |
  Passed: <span id="round">0</span>/20
</p>
<div>
<button onclick="doAction('jump')">‚¨ÜÔ∏è</button>
<button onclick="doAction('flip')">üîÑ</button>
<button onclick="doAction('hit')">üëä</button>
<button onclick="doAction('kick')">ü¶µ</button>
&nbsp;&nbsp;&nbsp;&nbsp;
<button id="pauseBtn" onclick="togglePause()">‚è∏Ô∏è</button>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

/* ---------- –ö–û–ù–°–¢–ê–ù–¢–ê –î–õ–Ø –ó–ï–ú–õ–ò ---------- */
const GROUND_Y = 160; // —É—Ä–æ–≤–µ–Ω—å –∑–µ–º–ª–∏, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∏–≥—Ä–æ–∫ –∏ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è

/* ---------- –î–ê–ù–ù–´–ï ---------- */
let score = 0;
let lives = 3;
let roundCount = 0;
const roundGoal = 20;
let gameSpeed = 1.3;
let obstacle = null;
let canAct = false;
let lastAction = null;
let paused = false;

/* ---------- –ò–ì–†–û–ö ---------- */
const player = {
  x: 120,
  baseY: GROUND_Y - 60, // —Å—Ç–æ–∏–º –Ω–∞ –∑–µ–º–ª–µ, —Ä–æ—Å—Ç –∏–≥—Ä–æ–∫–∞ 60px
  y: GROUND_Y - 60,
  w: 40,
  h: 60,
  action: "run",
  animTimer: 0,
  rotation: 0
};

/* ---------- –ü–†–ï–ü–Ø–¢–°–¢–í–ò–Ø ---------- */
const obstacles = [
  {type:"lava",   action:"flip", points:4},
  {type:"gap",    action:"jump", points:2},
  {type:"cactus", action:"hit",  points:2},
  {type:"wall",   action:"kick", points:3}
];

/* ---------- UI ---------- */
function updateUI(){
  document.getElementById("score").textContent = score;
  document.getElementById("lives").textContent = "‚ù§Ô∏è".repeat(lives);
  document.getElementById("round").textContent = roundCount;
}

function togglePause() {
  paused = !paused;

  const btn = document.getElementById("pauseBtn");

  if(paused){
    btn.textContent = "‚ñ∂Ô∏è"; // –∫–Ω–æ–ø–∫–∞ —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç ¬´Play¬ª
  } else {
    btn.textContent = "‚è∏Ô∏è"; // –∫–Ω–æ–ø–∫–∞ —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç ¬´Pause¬ª
    update(); // –≤–æ–∑–æ–±–Ω–æ–≤–ª—è–µ–º —Ü–∏–∫–ª –∏–≥—Ä—ã
  }
}

/* ---------- –°–ü–ê–í–ù ---------- */
function spawnObstacle(){
  const o = obstacles[Math.floor(Math.random() * obstacles.length)];
  obstacle = {
    x: canvas.width,
    y: GROUND_Y - 40, // –≤—Å–µ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è —Å—Ç–æ—è—Ç –Ω–∞ –∑–µ–º–ª–µ, –≤—ã—Å–æ—Ç–∞ ~40px
    w: 40,
    h: 40,
    type: o.type,
    action: o.action,
    points: o.points
  };
  canAct = true;
  lastAction = null;
}

/* ---------- –ö–ù–û–ü–ö–ò ---------- */
function doAction(a){
  if(!canAct) return;
  lastAction = a;
  player.action = a;
  player.animTimer = 100;
  if(a==="flip"){
    player.rotation = 0;
  }
}

/* ---------- –£–°–ü–ï–• ---------- */
function success(){
  if(!obstacle) return;

  score += obstacle.points;
  roundCount++;

  // –µ—Å–ª–∏ —ç—Ç–æ –Ω–µ —è–º–∞, —É–±–∏—Ä–∞–µ–º –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–µ
  if(obstacle.type !== "gap" && obstacle.type !== "lava"){
    obstacle = null;
    canAct = false;
  } else {
    canAct = false; // –∏–≥—Ä–æ–∫ —É–∂–µ –¥–µ–π—Å—Ç–≤–æ–≤–∞–ª, –Ω–æ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–µ –æ—Å—Ç–∞—ë—Ç—Å—è
  }

  if(roundCount >= roundGoal){
    score += 10;
    roundCount = 0;
    alert("üéâ –†–∞—É–Ω–¥ –ø—Ä–æ–π–¥–µ–Ω!");
  }
}

/* ---------- –ü–†–û–í–ê–õ ---------- */
function fail(){
  if(!obstacle) return;
  lives--;
  obstacle = null;
  canAct = false;
  player.action = "run";
  player.rotation = 0;

  if(lives <= 0){
    alert("üíÄ –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞: "+score);
    resetGame();
  }
}

/* ---------- –°–ë–†–û–° ---------- */
function resetGame(){
  score = 0;
  lives = 3;
  roundCount = 0;
  obstacle = null;
  canAct = false;
  updateUI();
}

/* ---------- –§–û–ù ---------- */
function drawBackground(){
  ctx.fillStyle="#f2d16b";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // –ó–µ–º–ª—è
  ctx.fillStyle="#654321";
  ctx.fillRect(0,GROUND_Y,canvas.width,canvas.height - GROUND_Y);
}

/* ---------- –ê–ù–ò–ú–ê–¶–ò–ò ---------- */
function updateAnim(){
  if(player.animTimer > 0){
    player.animTimer--;
    if(player.action==="jump"){
      player.y = player.baseY - 40;
    }
    if(player.action==="flip"){
      player.y = player.baseY - 55;
      player.rotation += Math.PI/20;
    }
  }else{
    player.y = player.baseY;
    player.action = "run";
    player.rotation = 0;
  }
}

/* ---------- –ò–ì–†–û–ö ---------- */
function drawPlayer(){
  updateAnim();
  ctx.save();
  ctx.translate(player.x + 20, player.y + 30);
  ctx.rotate(player.rotation);
  ctx.translate(-20,-30);

  // –ì–æ–ª–æ–≤–∞
  ctx.fillStyle="#ffe0bd";
  ctx.fillRect(10,0,20,20);

  // –ü–∞–ª—å—Ç–æ
  ctx.fillStyle="brown";
  ctx.fillRect(0,20,40,40);

  // –†—é–∫–∑–∞–∫
  ctx.fillStyle="darkblue";
  ctx.fillRect(-10,25,10,25);

  // –®–ª—è–ø–∞
  ctx.fillStyle="black";
  ctx.fillRect(5,-5,30,5);
  ctx.fillRect(12,-15,15,10);

  // –†—É–∫–∞
  ctx.fillStyle="orange";
  if(player.action==="hit"){
    ctx.fillRect(35,25,25,10);
  }else{
    ctx.fillRect(32,35,8,15);
  }

  // –ù–æ–≥–∞
  if(player.action==="kick"){
    ctx.fillStyle="#ffe0bd";
    ctx.fillRect(30,55,25,8);
  }

  ctx.restore();
}

/* ---------- –ü–†–ï–ü–Ø–¢–°–¢–í–ò–Ø ---------- */
function drawObstacle(){
  if(!obstacle) return;

  // –õ–ê–í–ê
  if(obstacle.type==="lava"){
    ctx.fillStyle="red";
    ctx.fillRect(obstacle.x, GROUND_Y - 20, 40, 20);
    ctx.font="26px Arial";
    ctx.fillText("üî•üî•", obstacle.x-2, GROUND_Y - 5);
  }

  // –ö–ê–ö–¢–£–°
  if(obstacle.type==="cactus"){
    ctx.font = "50px Arial";
    ctx.fillText("üåµ", obstacle.x+2, GROUND_Y); // —Å—Ç–æ–∏—Ç –Ω–∞ –∑–µ–º–ª–µ
  }

  // –°–¢–ï–ù–ê
  if(obstacle.type==="wall"){
    ctx.fillStyle="gray";
    ctx.fillRect(obstacle.x, GROUND_Y - 70, 40, 70);
    ctx.fillStyle="darkgray";
    for(let i=0;i<5;i++){
      ctx.fillRect(obstacle.x, i*14 + (GROUND_Y - 70), 40,2);
    }
  }

  // –û–ë–†–´–í
  if(obstacle.type==="gap"){
    ctx.fillStyle="#f2d16b";
    ctx.fillRect(obstacle.x, GROUND_Y, 40, 40);
    ctx.fillStyle="#f2d16b";
    ctx.fillRect(obstacle.x+5,GROUND_Y + 5,30,35);
  }
}

/* ---------- –¶–ò–ö–õ ---------- */
function update(){
  if(paused) {
    updateUI(); // UI –º–æ–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –æ—á–∫–∏ –∏ –∂–∏–∑–Ω–∏
    return;     // –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –æ—Å—Ç–∞–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É
  }

  drawBackground();
  drawPlayer();

  // –°–ø–∞–≤–Ω
  if(!obstacle && Math.random()<0.015){
    spawnObstacle();
  }

  // –î–≤–∏–∂–µ–Ω–∏–µ
  if(obstacle){
    obstacle.x -= gameSpeed;

    if(obstacle.x < player.x + 40 && obstacle.x + 40 > player.x){
      if(canAct){
        if(lastAction===obstacle.action){
          success();
        }else{
          fail();
        }
      }
    }

    if(obstacle){
      if(canAct && obstacle.x + 40 < player.x){
        fail();
      }
    }

    if(obstacle && obstacle.x + 40 < 0 && !canAct){
      obstacle = null;
    }
  }

  drawObstacle();
  updateUI();
  requestAnimationFrame(update);
}

/* ---------- –°–¢–ê–†–¢ ---------- */
update();
</script>

</body>
</html>
